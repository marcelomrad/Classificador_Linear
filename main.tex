\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{main}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{introduuxe7uxe3o}{%
\section{Introdução}\label{introduuxe7uxe3o}}

Ao longo do nosso curso, fomos apresentados a diversos conceitos e
técnicas que moldam o campo da geometria computacional. Um dos desafios
mais intrigantes é a tarefa de classificação, onde buscamos categorizar
dados com base em suas características. Neste trabalho, vamos explorar a
implementação prática de modelos de classificação em aprendizado
supervisionado, com ênfase na determinação da separabilidade linear dos
dados. Através desta investigação, esperamos não apenas solidificar
nosso entendimento dos tópicos discutidos em sala de aula, mas também
avaliar a eficácia e precisão dos modelos lineares em conjuntos de dados
reais. Com experimentos cuidadosamente planejados e uma análise
aprofundada dos resultados, buscamos oferecer insights valiosos sobre a
aplicabilidade e limitações dos classificadores lineares no mundo real.

    \hypertarget{participantes-do-grupo}{%
\subsection{Participantes do Grupo}\label{participantes-do-grupo}}

\textbf{Arthur Linhares Madureira}: 2021031599

\textbf{Henrique da Fonseca Diniz Freitas}: 2021031688

\textbf{Marcelo Augusto Mrad Marteleto}: 2021031548

    \hypertarget{instalauxe7uxe3o-das-bibliotecas-necessuxe1rias-e-atuxedpicas}{%
\subsection{Instalação das bibliotecas necessárias e
atípicas}\label{instalauxe7uxe3o-das-bibliotecas-necessuxe1rias-e-atuxedpicas}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{o}{\PYZpc{}}\PY{k}{pip} install sortedcontainers
\PY{o}{\PYZpc{}}\PY{k}{pip} install ucimlrepo
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Requirement already satisfied: sortedcontainers in
c:\textbackslash{}users\textbackslash{}henri\textbackslash{}appdata\textbackslash{}local\textbackslash{}programs\textbackslash{}python\textbackslash{}python311\textbackslash{}lib\textbackslash{}site-packages (2.4.0)
Note: you may need to restart the kernel to use updated packages.
Requirement already satisfied: ucimlrepo in
c:\textbackslash{}users\textbackslash{}henri\textbackslash{}appdata\textbackslash{}local\textbackslash{}programs\textbackslash{}python\textbackslash{}python311\textbackslash{}lib\textbackslash{}site-packages (0.0.3)
Note: you may need to restart the kernel to use updated packages.
    \end{Verbatim}

    \hypertarget{importauxe7uxe3o-das-bibliotecas-necessuxe1rias}{%
\subsection{Importação das bibliotecas
necessárias}\label{importauxe7uxe3o-das-bibliotecas-necessuxe1rias}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}import das bibliotecas necessárias}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{random}
\PY{k+kn}{from} \PY{n+nn}{functools} \PY{k+kn}{import} \PY{n}{cmp\PYZus{}to\PYZus{}key}
\PY{k+kn}{from} \PY{n+nn}{sortedcontainers} \PY{k+kn}{import} \PY{n}{SortedList}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k+kn}{import} \PY{n}{PCA}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{StandardScaler}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{define_orientauxe7uxe3o}{%
\paragraph{\texorpdfstring{\texttt{define\_orientação}}{define\_orientação}}\label{define_orientauxe7uxe3o}}

Determina a orientação do trio ordenado (p, q, r). Se o resultado for 0,
então colinear. Se for 1, então horário. Se for -1, então anti-horário.

\hypertarget{verifica_segmento}{%
\paragraph{\texorpdfstring{\texttt{verifica\_segmento}}{verifica\_segmento}}\label{verifica_segmento}}

Verifica se o ponto q está no segmento PR

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{define\PYZus{}orientacao}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n}{q}\PY{p}{,} \PY{n}{r}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Determina a orientação do trio ordenado (p, q, r).}
\PY{l+s+sd}{    Se o resultado for 0, então colinear}
\PY{l+s+sd}{    Se for 1, então horário}
\PY{l+s+sd}{    Se for \PYZhy{}1, então anti\PYZhy{}horário}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{n}{val} \PY{o}{=} \PY{p}{(}\PY{n}{q}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{p}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{r}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{q}\PY{o}{.}\PY{n}{x}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{q}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{p}\PY{o}{.}\PY{n}{x}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{r}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{q}\PY{o}{.}\PY{n}{y}\PY{p}{)}
    \PY{k}{if} \PY{n}{val} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{k}{return} \PY{l+m+mi}{0}
    \PY{k}{return} \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{val} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}


\PY{k}{def} \PY{n+nf}{verifica\PYZus{}segmento}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n}{q}\PY{p}{,} \PY{n}{r}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{    Verifica se o ponto q está no segmento pr}
\PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{k}{return} \PY{p}{(}\PY{n}{q}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{r}\PY{o}{.}\PY{n}{x}\PY{p}{)} \PY{o+ow}{and} \PY{n}{q}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{r}\PY{o}{.}\PY{n}{x}\PY{p}{)} \PY{o+ow}{and}
            \PY{n}{q}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{r}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{o+ow}{and} \PY{n}{q}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n+nb}{min}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{r}\PY{o}{.}\PY{n}{y}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{classes-utilizadas}{%
\subsection{Classes Utilizadas}\label{classes-utilizadas}}

A criação de classes foi utilizada para fornecer uma abordagem intuitiva
e eficiente durante a implementação dos algoritmos e para deixar o
código mais reutilizavél.

\hypertarget{classe-ponto}{%
\subsubsection{Classe Ponto}\label{classe-ponto}}

A classe \texttt{Ponto} serve como uma representação de um ponto no
plano cartesiano. Seu principal propósito é definir posições e permitir
operações aritméticas básicas entre pontos. Esta classe é essencial para
realizar cálculos e manipular pontos.

\hypertarget{classe-segmento}{%
\subsubsection{Classe Segmento}\label{classe-segmento}}

A classe \texttt{Segmento} foi projetada para representar um segmento de
reta no plano cartesiano, definido por dois pontos. Ela desempenha um
papel crucial na determinação de relações entre segmentos de reta, como
detectar interseções. Esta classe fornece as funcionalidades necessárias
para analisar e comparar segmentos de reta com precisão.

\hypertarget{classe-evento}{%
\subsubsection{Classe Evento}\label{classe-evento}}

A classe \texttt{Evento} é especificamente adaptada para algoritmos de
varredura linear.Esta classe auxilia no processamento e ordenação de
eventos que ocorrem durante a varredura de forma a gerenciar eventos de
forma eficiente.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{class} \PY{n+nc}{Ponto}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x} \PY{o}{=} \PY{n}{x}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{=} \PY{n}{y}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}sub\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n}{Ponto}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{other}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{other}\PY{o}{.}\PY{n}{y}\PY{p}{)}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}repr\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{(}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{)}\PY{l+s+s2}{\PYZdq{}}

    \PY{k}{def} \PY{n+nf}{distancia\PYZus{}ao\PYZus{}quadrado}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{other}\PY{o}{.}\PY{n}{x}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{o}{+} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{other}\PY{o}{.}\PY{n}{y}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}

\PY{k}{class} \PY{n+nc}{Segmento}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1} \PY{o}{=} \PY{n}{p1}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2} \PY{o}{=} \PY{n}{p2}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}repr\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{[}\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{, }\PY{l+s+si}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{]}\PY{l+s+s2}{\PYZdq{}}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}hash\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n+nb}{hash}\PY{p}{(}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{)}\PY{p}{)}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}eq\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n+nb}{isinstance}\PY{p}{(}\PY{n}{other}\PY{p}{,} \PY{n}{Segmento}\PY{p}{)} \PY{o+ow}{and} \PY{p}{\PYZob{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{\PYZcb{}} \PY{o}{==} \PY{p}{\PYZob{}}\PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{p}{\PYZcb{}}

    \PY{k}{def} \PY{n+nf}{intersecao}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{)}\PY{p}{:}
        \PY{n}{o1} \PY{o}{=} \PY{n}{define\PYZus{}orientacao}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{p}{)}
        \PY{n}{o2} \PY{o}{=} \PY{n}{define\PYZus{}orientacao}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{p}{)}
        \PY{n}{o3} \PY{o}{=} \PY{n}{define\PYZus{}orientacao}\PY{p}{(}\PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{)}
        \PY{n}{o4} \PY{o}{=} \PY{n}{define\PYZus{}orientacao}\PY{p}{(}\PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{)}

        \PY{c+c1}{\PYZsh{} Condições principais de interseção}
        \PY{k}{if} \PY{n}{o1} \PY{o}{*} \PY{n}{o2} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{o3} \PY{o}{*} \PY{n}{o4} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{k}{return} \PY{k+kc}{True}

        \PY{c+c1}{\PYZsh{} Casos especiais: se os segmentos são colineares e se cruzam}
        \PY{k}{if} \PY{n}{o1} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{verifica\PYZus{}segmento}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{k+kc}{True}
        \PY{k}{if} \PY{n}{o2} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{verifica\PYZus{}segmento}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{k+kc}{True}
        \PY{k}{if} \PY{n}{o3} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{verifica\PYZus{}segmento}\PY{p}{(}\PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{k+kc}{True}
        \PY{k}{if} \PY{n}{o4} \PY{o}{==} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{verifica\PYZus{}segmento}\PY{p}{(}\PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{k+kc}{True}

        \PY{k}{return} \PY{k+kc}{False}


    \PY{k}{def} \PY{n+nf}{produto\PYZus{}vetorial}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{x}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{x}\PY{p}{)}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}lt\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZlt{}} \PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{y} \PY{o+ow}{or} \PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{y} \PY{o}{==} \PY{n}{other}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{y} \PY{o+ow}{and} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZlt{}} \PY{n}{other}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{y}\PY{p}{)}

\PY{k}{class} \PY{n+nc}{Event}\PY{p}{:}
    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{segment}\PY{p}{,} \PY{n}{is\PYZus{}start}\PY{p}{,} \PY{n}{poligono}\PY{p}{)}\PY{p}{:}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x} \PY{o}{=} \PY{n}{x}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{=} \PY{n}{y}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{segment} \PY{o}{=} \PY{n}{segment}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{is\PYZus{}start} \PY{o}{=} \PY{n}{is\PYZus{}start}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{poligono} \PY{o}{=} \PY{n}{poligono}

    \PY{k}{def} \PY{n+nf+fm}{\PYZus{}\PYZus{}lt\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x} \PY{o}{!=} \PY{n}{other}\PY{o}{.}\PY{n}{x}\PY{p}{:}
            \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZlt{}} \PY{n}{other}\PY{o}{.}\PY{n}{x}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZlt{}} \PY{n}{other}\PY{o}{.}\PY{n}{y}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}

    \hypertarget{funuxe7uxe3o-de-ordenauxe7uxe3o-polar}{%
\subsection{Função de Ordenação
Polar}\label{funuxe7uxe3o-de-ordenauxe7uxe3o-polar}}

A função \texttt{ordenacao\_polar} é usada para ordenar pontos com base
em seus ângulos polares em relação a um ponto de referência \texttt{p0}.

\hypertarget{paruxe2metros}{%
\subsubsection{Parâmetros:}\label{paruxe2metros}}

\begin{itemize}
\tightlist
\item
  \texttt{p0}: Ponto de referência em relação ao qual os outros pontos
  serão ordenados.
\end{itemize}

\hypertarget{luxf3gica-de-comparauxe7uxe3o}{%
\paragraph{Lógica de Comparação:}\label{luxf3gica-de-comparauxe7uxe3o}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se \texttt{p1} e \texttt{p2} são colineares em relação a \texttt{p0},
  a distância deles até \texttt{p0} é comparada. O ponto mais próximo de
  \texttt{p0} é considerado menor.
\item
  Se não são colineares, o ponto que forma um ângulo menor (ou seja,
  está à direita ao observar a partir de \texttt{p0}) é considerado
  menor.
\end{enumerate}

\hypertarget{retorno}{%
\paragraph{Retorno:}\label{retorno}}

\begin{itemize}
\tightlist
\item
  \texttt{-1} se \texttt{p1} vem antes de \texttt{p2}.
\item
  \texttt{1} se \texttt{p1} vem depois de \texttt{p2}.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{ordenacao\PYZus{}polar}\PY{p}{(}\PY{n}{p0}\PY{p}{)}\PY{p}{:}
    \PY{k}{def} \PY{n+nf}{compare}\PY{p}{(}\PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}\PY{p}{:}
        \PY{n}{o} \PY{o}{=} \PY{n}{define\PYZus{}orientacao}\PY{p}{(}\PY{n}{p0}\PY{p}{,} \PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}
        \PY{k}{if} \PY{n}{o} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{k}{if} \PY{n}{p1}\PY{o}{.}\PY{n}{distancia\PYZus{}ao\PYZus{}quadrado}\PY{p}{(}\PY{n}{p0}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{n}{p2}\PY{o}{.}\PY{n}{distancia\PYZus{}ao\PYZus{}quadrado}\PY{p}{(}\PY{n}{p0}\PY{p}{)}\PY{p}{:}
                \PY{k}{return} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
            \PY{k}{else}\PY{p}{:}
                \PY{k}{return} \PY{l+m+mi}{1}
        \PY{k}{return} \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{o} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{k}{else} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
    \PY{k}{return} \PY{n}{compare}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{implementauxe7uxe3o}{%
\section{Implementação}\label{implementauxe7uxe3o}}

    \hypertarget{algoritmo-de-graham-scan-para-envolvuxf3ria-convexa}{%
\subsection{Algoritmo de Graham Scan para Envolvória
Convexa}\label{algoritmo-de-graham-scan-para-envolvuxf3ria-convexa}}

O algoritmo de Graham Scan é uma abordagem eficiente para encontrar a
envoltória convexa de um conjunto de pontos no plano. A envoltória
convexa é o menor polígono convexo que contém todos os pontos de um
conjunto.

\hypertarget{passo-a-passo-da-funuxe7uxe3o-graham_scan}{%
\subsubsection{\texorpdfstring{\textbf{Passo a passo da função
\texttt{graham\_scan}:}}{Passo a passo da função graham\_scan:}}\label{passo-a-passo-da-funuxe7uxe3o-graham_scan}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Verificação inicial de quantidade de pontos}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Caso haja menos de 3 pontos no conjunto, a função retorna diretamente
  os pontos originais, pois não é possível formar uma envoltória convexa
  com menos de 3 pontos.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \textbf{Encontrando o ponto de partida, \texttt{p0}}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Os pontos são ordenados primeiramente pela coordenada \texttt{y} e, em
  caso de empate, pela coordenada \texttt{x}.
\item
  O ponto mais à esquerda e mais abaixo (menor \texttt{y} e menor
  \texttt{x}) é escolhido como \texttt{p0}.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \textbf{Ordenação Polar dos Pontos}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Todos os pontos, exceto \texttt{p0}, são ordenados de acordo com seus
  ângulos polares em relação a \texttt{p0}.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  \textbf{Construção da Envolvória Convexa}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Inicializamos a envoltória com \texttt{p0} e o primeiro ponto da lista
  ordenada.
\item
  Percorremos os pontos ordenados e continuamos adicionando à envoltória
  até que seja garantido que a envoltória permaneça convexa.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  \textbf{Fechamento da Envolvória}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Para fechar o polígono convexo, adicionamos o ponto \texttt{p0}
  novamente ao final da envoltória.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}Algoritmo de Graham Scan para criar a envoltoŕia convexa}

\PY{k}{def} \PY{n+nf}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{pontos}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{pontos}\PY{p}{)} \PY{o}{\PYZlt{}} \PY{l+m+mi}{3}\PY{p}{:}
        \PY{k}{return} \PY{n}{pontos}  \PY{c+c1}{\PYZsh{} Retorna os pontos originais se houver menos de 3}

    \PY{n}{pontos} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{pontos}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{k}{lambda} \PY{n}{p}\PY{p}{:} \PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{p}\PY{o}{.}\PY{n}{x}\PY{p}{)}\PY{p}{)}
    \PY{n}{p0} \PY{o}{=} \PY{n}{pontos}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{pontos\PYZus{}ordenados} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{pontos}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{n}{cmp\PYZus{}to\PYZus{}key}\PY{p}{(}\PY{n}{ordenacao\PYZus{}polar}\PY{p}{(}\PY{n}{p0}\PY{p}{)}\PY{p}{)}\PY{p}{)}

    \PY{n}{envoltoria} \PY{o}{=} \PY{p}{[}\PY{n}{p0}\PY{p}{,} \PY{n}{pontos\PYZus{}ordenados}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}
    \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{pontos\PYZus{}ordenados}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{:}
        \PY{k}{while} \PY{n+nb}{len}\PY{p}{(}\PY{n}{envoltoria}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1} \PY{o+ow}{and} \PY{n}{Segmento}\PY{p}{(}\PY{n}{envoltoria}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,} \PY{n}{envoltoria}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{produto\PYZus{}vetorial}\PY{p}{(}\PY{n}{Segmento}\PY{p}{(}\PY{n}{envoltoria}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{p}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{0}\PY{p}{:}
            \PY{n}{envoltoria}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{p}{)}
        \PY{n}{envoltoria}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{p}\PY{p}{)}

    \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{envoltoria}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{2}\PY{p}{:}
        \PY{n}{envoltoria}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{p0}\PY{p}{)}

    \PY{k}{return} \PY{n}{envoltoria}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{visualizauxe7uxe3o-da-envolvuxf3ria-convexa}{%
\subsection{Visualização da Envolvória
Convexa}\label{visualizauxe7uxe3o-da-envolvuxf3ria-convexa}}

Para visualizar o conjunto de pontos e sua envoltória convexa, é
definida a função \texttt{plot\_envoltoria}.

\hypertarget{funuxe7uxe3o-plot_envoltoria}{%
\subsubsection{\texorpdfstring{Função
\texttt{plot\_envoltoria}}{Função plot\_envoltoria}}\label{funuxe7uxe3o-plot_envoltoria}}

A função toma como entrada dois conjuntos de pontos: - \texttt{pontos}:
O conjunto completo de pontos. - \texttt{envoltoria}: A envoltória
convexa calculada.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Função para plotar a envoltória convexa}

\PY{k}{def} \PY{n+nf}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{pontos}\PY{p}{,} \PY{n}{envoltoria}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} Plotar todos os pontos}
    \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{pontos}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{y} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{pontos}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Plotar a envoltória convexa}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{envoltoria}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{envoltoria}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{envoltoria}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{envoltoria}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{envoltoria}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Fechar a envoltória}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{envoltoria}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{envoltoria}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{envoltoria}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{envoltoria}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Gerar pontos aleatórios para testar o algoritmo e posteriormente plotar a envoltória convexa}
\PY{n}{pontos} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}\PY{p}{,} \PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{)}\PY{p}{]}
\PY{n}{envoltoria} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{pontos}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{pontos}\PY{p}{,} \PY{n}{envoltoria}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{detectando-interseuxe7uxf5es-de-segmentos}{%
\subsection{Detectando Interseções de
Segmentos}\label{detectando-interseuxe7uxf5es-de-segmentos}}

A função \texttt{segmentos\_que\_se\_cruzam} determina quais pares de
segmentos se cruzam de uma lista de segmentos.

\hypertarget{funcionalidades}{%
\subsubsection{Funcionalidades}\label{funcionalidades}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{cruzam(seg1,\ seg2)}: Uma função auxiliar que determina se os
  segmentos \texttt{seg1} e \texttt{seg2} se cruzam.
\item
  \texttt{segmentos\_que\_se\_cruzam(segmentos,\ poligonos)}: Esta é a
  principal função que retorna uma lista de pares de segmentos que se
  cruzam.
\end{enumerate}

\hypertarget{descriuxe7uxe3o-do-algoritmo}{%
\subsubsection{Descrição do
Algoritmo}\label{descriuxe7uxe3o-do-algoritmo}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Inicialização}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Uma lista \texttt{eventos} é inicializada para armazenar eventos
  associados ao início e ao fim de cada segmento.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \textbf{População de Eventos}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Para cada segmento, os pontos de início e fim são determinados com
  base nas coordenadas x. Esses são adicionados à lista de
  \texttt{eventos}.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \textbf{Ordenação de Eventos}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Os eventos são ordenados com base nas coordenadas x e y dos pontos
  associados.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  \textbf{Processamento de Eventos}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Uma lista ordenada \texttt{active\_segments} é inicializada para
  armazenar segmentos ativos.
\item
  Para cada evento na lista ordenada de eventos:
\item
  Se o evento for do tipo `start':
\item
  Verifica-se possíveis interseções com segmentos adjacentes na lista
  \texttt{active\_segments}.
\item
  O segmento é então adicionado à lista \texttt{active\_segments}.
\item
  Se o evento for do tipo `end':
\item
  Verifica-se interseções entre os segmentos vizinhos.
\item
  O segmento é removido de \texttt{active\_segments}.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  \textbf{Resultado}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  A função retorna uma lista de pares de segmentos que se cruzam.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{cruzam}\PY{p}{(}\PY{n}{seg1}\PY{p}{,} \PY{n}{seg2}\PY{p}{)}\PY{p}{:}
\PY{+w}{    }\PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Verifica se os segmentos seg1 e seg2 se cruzam \PYZdq{}\PYZdq{}\PYZdq{}}
    \PY{c+c1}{\PYZsh{} Usa sua função \PYZsq{}intersecao\PYZsq{} já definida anteriormente}
    \PY{k}{return} \PY{n}{seg1}\PY{o}{.}\PY{n}{intersecao}\PY{p}{(}\PY{n}{seg2}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{segmentos\PYZus{}que\PYZus{}se\PYZus{}cruzam}\PY{p}{(}\PY{n}{segmentos}\PY{p}{,} \PY{n}{poligonos}\PY{p}{)}\PY{p}{:}
    \PY{n}{segmento\PYZus{}para\PYZus{}poligono} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{seg}\PY{p}{:} \PY{n}{pol} \PY{k}{for} \PY{n}{seg}\PY{p}{,} \PY{n}{pol} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{segmentos}\PY{p}{,} \PY{n}{poligonos}\PY{p}{)}\PY{p}{\PYZcb{}}

    \PY{n}{eventos} \PY{o}{=} \PY{p}{[}\PY{p}{]}
    \PY{k}{for} \PY{n}{seg} \PY{o+ow}{in} \PY{n}{segmentos}\PY{p}{:}
        \PY{n}{start} \PY{o}{=} \PY{n}{seg}\PY{o}{.}\PY{n}{p1} \PY{k}{if} \PY{n}{seg}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZlt{}} \PY{n}{seg}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{x} \PY{k}{else} \PY{n}{seg}\PY{o}{.}\PY{n}{p2}
        \PY{n}{end} \PY{o}{=} \PY{n}{seg}\PY{o}{.}\PY{n}{p2} \PY{k}{if} \PY{n}{seg}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZlt{}} \PY{n}{seg}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{x} \PY{k}{else} \PY{n}{seg}\PY{o}{.}\PY{n}{p1}
        \PY{n}{eventos}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{start}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{seg}\PY{p}{)}\PY{p}{)}
        \PY{n}{eventos}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{end}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{end}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{seg}\PY{p}{)}\PY{p}{)}

    \PY{n}{eventos}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{key}\PY{o}{=}\PY{k}{lambda} \PY{n}{e}\PY{p}{:} \PY{p}{(}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{)}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Usando SortedList da biblioteca sortedcontainers, com custo de inserção e remoção O(log n)}
    \PY{n}{segmentos\PYZus{}ativos} \PY{o}{=} \PY{n}{SortedList}\PY{p}{(}\PY{n}{key}\PY{o}{=}\PY{k}{lambda} \PY{n}{s}\PY{p}{:} \PY{p}{(}\PY{n}{s}\PY{o}{.}\PY{n}{p1}\PY{o}{.}\PY{n}{y} \PY{o}{+} \PY{n}{s}\PY{o}{.}\PY{n}{p2}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{intersecoes} \PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{p}{)}

    \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{tipo}\PY{p}{,} \PY{n}{segmento} \PY{o+ow}{in} \PY{n}{eventos}\PY{p}{:}
        \PY{k}{if} \PY{n}{tipo} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{start}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
            \PY{n}{idx} \PY{o}{=} \PY{n}{segmentos\PYZus{}ativos}\PY{o}{.}\PY{n}{bisect}\PY{p}{(}\PY{n}{segmento}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Verificar interseção com segmento abaixo}
            \PY{k}{if} \PY{n}{idx} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{segmento}\PY{o}{.}\PY{n}{intersecao}\PY{p}{(}\PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{idx} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o+ow}{and} \PY{n}{segmento\PYZus{}para\PYZus{}poligono}\PY{p}{[}\PY{n}{segmento}\PY{p}{]} \PY{o}{!=} \PY{n}{segmento\PYZus{}para\PYZus{}poligono}\PY{p}{[}\PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{idx} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{:}
                \PY{n}{intersecoes}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{p}{[}\PY{n}{segmento}\PY{p}{,} \PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{idx} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{c+c1}{\PYZsh{} Verificar interseção com segmento acima}
            \PY{k}{if} \PY{n}{idx} \PY{o}{\PYZlt{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{segmentos\PYZus{}ativos}\PY{p}{)} \PY{o+ow}{and} \PY{n}{segmento}\PY{o}{.}\PY{n}{intersecao}\PY{p}{(}\PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{)} \PY{o+ow}{and} \PY{n}{segmento\PYZus{}para\PYZus{}poligono}\PY{p}{[}\PY{n}{segmento}\PY{p}{]} \PY{o}{!=} \PY{n}{segmento\PYZus{}para\PYZus{}poligono}\PY{p}{[}\PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{]}\PY{p}{:}
                \PY{n}{intersecoes}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{p}{[}\PY{n}{segmento}\PY{p}{,} \PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{idx}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}

            \PY{n}{segmentos\PYZus{}ativos}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{segmento}\PY{p}{)}
        \PY{k}{else}\PY{p}{:}
            \PY{k}{if} \PY{n}{segmento} \PY{o+ow}{in} \PY{n}{segmentos\PYZus{}ativos}\PY{p}{:}
                \PY{n}{segmento\PYZus{}idx} \PY{o}{=} \PY{n}{segmentos\PYZus{}ativos}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n}{segmento}\PY{p}{)}

                \PY{c+c1}{\PYZsh{} Verificar interseção entre segmentos vizinhos}
                \PY{k}{if} \PY{l+m+mi}{0} \PY{o}{\PYZlt{}} \PY{n}{segmento\PYZus{}idx} \PY{o}{\PYZlt{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{segmentos\PYZus{}ativos}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{:}
                    \PY{n}{seg\PYZus{}below} \PY{o}{=} \PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{segmento\PYZus{}idx} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{]}
                    \PY{n}{seg\PYZus{}above} \PY{o}{=} \PY{n}{segmentos\PYZus{}ativos}\PY{p}{[}\PY{n}{segmento\PYZus{}idx} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}
                    \PY{k}{if} \PY{n}{seg\PYZus{}below}\PY{o}{.}\PY{n}{intersecao}\PY{p}{(}\PY{n}{seg\PYZus{}above}\PY{p}{)} \PY{o+ow}{and} \PY{n}{segmento\PYZus{}para\PYZus{}poligono}\PY{p}{[}\PY{n}{seg\PYZus{}below}\PY{p}{]} \PY{o}{!=} \PY{n}{segmento\PYZus{}para\PYZus{}poligono}\PY{p}{[}\PY{n}{seg\PYZus{}above}\PY{p}{]}\PY{p}{:}
                        \PY{n}{intersecoes}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{p}{[}\PY{n}{seg\PYZus{}below}\PY{p}{,} \PY{n}{seg\PYZus{}above}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}

                \PY{n}{segmentos\PYZus{}ativos}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{n}{segmento}\PY{p}{)}

    \PY{k}{return} \PY{n+nb}{list}\PY{p}{(}\PY{n}{intersecoes}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{verificando-separabilidade-linear-entre-duas-classes}{%
\subsection{Verificando Separabilidade Linear entre Duas
Classes}\label{verificando-separabilidade-linear-entre-duas-classes}}

A função \texttt{verificar\_separabilidade\_linear} determina se dois
conjuntos de pontos, \texttt{classe\_1} e \texttt{classe\_2}, podem ser
linearmente separados.

\hypertarget{descriuxe7uxe3o-do-algoritmo}{%
\subsubsection{Descrição do
Algoritmo}\label{descriuxe7uxe3o-do-algoritmo}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Construção das Envoltórias Convexas}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Para cada conjunto de pontos, a envoltória convexa é construída usando
  o algoritmo de Graham Scan (\texttt{graham\_scan}).
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \textbf{Criação de Segmentos das Envoltórias}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Para cada envoltória convexa, criam-se segmentos de linha entre pontos
  consecutivos da envoltória.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \textbf{Verificação de Interseção entre Segmentos}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Todos os segmentos das duas classes são combinados em uma única lista
  \texttt{todos\_os\_segmentos}.
\item
  Uma lista \texttt{poligonos} é criada para identificar a qual classe
  pertence cada segmento (1 para \texttt{classe\_1} e 2 para
  \texttt{classe\_2}).
\item
  Utiliza-se a função \texttt{segmentos\_que\_se\_cruzam} para
  determinar se existem interseções entre os segmentos das duas
  envoltórias.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  \textbf{Resultado}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Se não houver interseções entre os segmentos das duas classes, as
  classes são linearmente separáveis e a função retorna \texttt{True}.
\item
  Caso contrário, a função retorna \texttt{False}.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{classe\PYZus{}1}\PY{p}{,} \PY{n}{classe\PYZus{}2}\PY{p}{)}\PY{p}{:}
    \PY{n}{envoltoria\PYZus{}classe\PYZus{}1} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{classe\PYZus{}1}\PY{p}{)}
    \PY{n}{envoltoria\PYZus{}classe\PYZus{}2} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{classe\PYZus{}2}\PY{p}{)}

    \PY{n}{segmentos\PYZus{}classe\PYZus{}1} \PY{o}{=} \PY{p}{[}\PY{n}{Segmento}\PY{p}{(}\PY{n}{envoltoria\PYZus{}classe\PYZus{}1}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{envoltoria\PYZus{}classe\PYZus{}1}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{envoltoria\PYZus{}classe\PYZus{}1}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
    \PY{n}{segmentos\PYZus{}classe\PYZus{}2} \PY{o}{=} \PY{p}{[}\PY{n}{Segmento}\PY{p}{(}\PY{n}{envoltoria\PYZus{}classe\PYZus{}2}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{envoltoria\PYZus{}classe\PYZus{}2}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{envoltoria\PYZus{}classe\PYZus{}2}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}

    \PY{n}{todos\PYZus{}os\PYZus{}segmentos} \PY{o}{=} \PY{n}{segmentos\PYZus{}classe\PYZus{}1} \PY{o}{+} \PY{n}{segmentos\PYZus{}classe\PYZus{}2}
    \PY{n}{poligonos} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{*} \PY{n+nb}{len}\PY{p}{(}\PY{n}{segmentos\PYZus{}classe\PYZus{}1}\PY{p}{)} \PY{o}{+} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{*} \PY{n+nb}{len}\PY{p}{(}\PY{n}{segmentos\PYZus{}classe\PYZus{}2}\PY{p}{)}

    \PY{n}{intersecoes} \PY{o}{=} \PY{n}{segmentos\PYZus{}que\PYZus{}se\PYZus{}cruzam}\PY{p}{(}\PY{n}{todos\PYZus{}os\PYZus{}segmentos}\PY{p}{,} \PY{n}{poligonos}\PY{p}{)}
    \PY{k}{return} \PY{n+nb}{len}\PY{p}{(}\PY{n}{intersecoes}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{visualizauxe7uxe3o-da-separabilidade-linear-entre-duas-classes}{%
\subsection{Visualização da Separabilidade Linear entre Duas
Classes}\label{visualizauxe7uxe3o-da-separabilidade-linear-entre-duas-classes}}

A função \texttt{plot\_separabilidade} tem como objetivo ilustrar
graficamente se dois conjuntos de pontos, representando duas classes
distintas, são linearmente separáveis no plano. Isso é feito através da
construção das envoltórias convexas de ambos os conjuntos e verificando
se elas se cruzam ou não.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{classe\PYZus{}1}\PY{p}{,} \PY{n}{classe\PYZus{}2}\PY{p}{)}\PY{p}{:}

    \PY{n}{classe\PYZus{}1} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{classe\PYZus{}1}\PY{p}{)}
    \PY{n}{classe\PYZus{}2} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{classe\PYZus{}2}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Verificar se os dados são linearmente separáveis}
    \PY{n}{separaveis} \PY{o}{=} \PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{classe\PYZus{}1}\PY{p}{,} \PY{n}{classe\PYZus{}2}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Plotar envoltória da classe 1}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{classe\PYZus{}1}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{classe\PYZus{}1}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{classe\PYZus{}1}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{]}\PY{p}{,}
                 \PY{p}{[}\PY{n}{classe\PYZus{}1}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{classe\PYZus{}1}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Plotar envoltória da classe 2}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{classe\PYZus{}2}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{classe\PYZus{}2}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{classe\PYZus{}2}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{x}\PY{p}{]}\PY{p}{,}
                 \PY{p}{[}\PY{n}{classe\PYZus{}2}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{classe\PYZus{}2}\PY{p}{[}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{y}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{k}{if} \PY{n}{separaveis}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Dados são linearmente separáveis!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Dados não são linearmente separáveis!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{X}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{gerar-pontos-aleatuxf3rios-para-ambas-as-classes}{%
\subsection{Gerar pontos aleatórios para ambas as
classes}\label{gerar-pontos-aleatuxf3rios-para-ambas-as-classes}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Gerar pontos aleatórios para ambas as classes}
\PY{n}{classe\PYZus{}1\PYZus{}random} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{]}
\PY{n}{classe\PYZus{}2\PYZus{}random} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{,} \PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{]}

\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{classe\PYZus{}1\PYZus{}random}\PY{p}{,} \PY{n}{classe\PYZus{}2\PYZus{}random}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_25_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{modelo-linear-baseado-em-envoltuxf3rios-convexos}{%
\subsection{Modelo Linear Baseado em Envoltórios
Convexos}\label{modelo-linear-baseado-em-envoltuxf3rios-convexos}}

Este código busca encontrar um modelo linear para separar dois conjuntos
de pontos no plano, assumindo que os pontos de cada conjunto estejam
agrupados e possam ser encapsulados por envoltórios convexos.

\hypertarget{funuxe7uxf5es}{%
\subsubsection{Funções:}\label{funuxe7uxf5es}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{\texttt{encontrar\_pontos\_mais\_proximos(env1,\ env2)}}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \textbf{Entrada}: Dois envoltórios convexos (listas de pontos).
\item
  \textbf{Saída}: Os pontos (um de cada envoltórios) que estão mais
  próximos entre si.
\item
  \textbf{Funcionamento}: A função itera sobre todos os pares de pontos
  entre os dois envoltórios e determina os pontos mais próximos com base
  na distância ao quadrado.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  \textbf{\texttt{construir\_modelo\_linear(pontos1,\ pontos2)}}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \textbf{Entrada}: Dois conjuntos de pontos.
\item
  \textbf{Saída}: Uma reta (definida por sua inclinação \texttt{m} e
  interceptação \texttt{b}) que serve como um modelo linear entre os
  dois envoltórios convexos formados a partir dos pontos de entrada.
\item
  \textbf{Funcionamento}: Esta função constrói os envoltórios convexos,
  verifica se são linearmente separáveis e, em seguida, calcula uma
  linha perpendicular ao segmento que liga os dois pontos mais próximos
  dos envelopes.
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  \textbf{\texttt{plot\_modelo(pontos1,\ pontos2)}}:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  \textbf{Entrada}: Dois conjuntos de pontos.
\item
  \textbf{Saída}: Um gráfico mostrando os dois envoltórios convexos, os
  pontos mais próximos e o modelo linear proposto.
\item
  \textbf{Funcionamento}: Esta função visualiza os dados e o modelo
  linear. Os envoltórios convexos são plotados em azul e vermelho,
  respectivamente, e o modelo linear é mostrado como uma linha ciano. Os
  pontos mais próximos são conectados por uma linha tracejada verde.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{encontrar\PYZus{}pontos\PYZus{}mais\PYZus{}proximos}\PY{p}{(}\PY{n}{env1}\PY{p}{,} \PY{n}{env2}\PY{p}{)}\PY{p}{:}
    \PY{n}{menor\PYZus{}distancia} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{inf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{ponto1} \PY{o}{=} \PY{k+kc}{None}
    \PY{n}{ponto2} \PY{o}{=} \PY{k+kc}{None}

    \PY{k}{for} \PY{n}{p1} \PY{o+ow}{in} \PY{n}{env1}\PY{p}{:}
        \PY{k}{for} \PY{n}{p2} \PY{o+ow}{in} \PY{n}{env2}\PY{p}{:}
            \PY{n}{distancia} \PY{o}{=} \PY{n}{p1}\PY{o}{.}\PY{n}{distancia\PYZus{}ao\PYZus{}quadrado}\PY{p}{(}\PY{n}{p2}\PY{p}{)}
            \PY{k}{if} \PY{n}{distancia} \PY{o}{\PYZlt{}} \PY{n}{menor\PYZus{}distancia}\PY{p}{:}
                \PY{n}{menor\PYZus{}distancia} \PY{o}{=} \PY{n}{distancia}
                \PY{n}{ponto1} \PY{o}{=} \PY{n}{p1}
                \PY{n}{ponto2} \PY{o}{=} \PY{n}{p2}

    \PY{k}{return} \PY{n}{ponto1}\PY{p}{,} \PY{n}{ponto2}

\PY{k}{def} \PY{n+nf}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{pontos1}\PY{p}{,} \PY{n}{pontos2}\PY{p}{)}\PY{p}{:}
    \PY{n}{env1} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{pontos1}\PY{p}{)}
    \PY{n}{env2} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{pontos2}\PY{p}{)}

    \PY{k}{if} \PY{o+ow}{not} \PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{env1}\PY{p}{,} \PY{n}{env2}\PY{p}{)}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Os dados não são linearmente separáveis.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{return} \PY{k+kc}{None}

    \PY{n}{ponto1}\PY{p}{,} \PY{n}{ponto2} \PY{o}{=} \PY{n}{encontrar\PYZus{}pontos\PYZus{}mais\PYZus{}proximos}\PY{p}{(}\PY{n}{env1}\PY{p}{,} \PY{n}{env2}\PY{p}{)}

    \PY{n}{ponto\PYZus{}medio} \PY{o}{=} \PY{n}{Ponto}\PY{p}{(}\PY{p}{(}\PY{n}{ponto1}\PY{o}{.}\PY{n}{x} \PY{o}{+} \PY{n}{ponto2}\PY{o}{.}\PY{n}{x}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}\PY{p}{,} \PY{p}{(}\PY{n}{ponto1}\PY{o}{.}\PY{n}{y} \PY{o}{+} \PY{n}{ponto2}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{o}{/} \PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{vetor\PYZus{}direcao} \PY{o}{=} \PY{n}{Ponto}\PY{p}{(}\PY{n}{ponto2}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{ponto1}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{ponto2}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{ponto1}\PY{o}{.}\PY{n}{y}\PY{p}{)}
    \PY{n}{vetor\PYZus{}direcao\PYZus{}perpendicular} \PY{o}{=} \PY{n}{Ponto}\PY{p}{(}\PY{n}{vetor\PYZus{}direcao}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{n}{vetor\PYZus{}direcao}\PY{o}{.}\PY{n}{x}\PY{p}{)}

    \PY{k}{if} \PY{n}{vetor\PYZus{}direcao\PYZus{}perpendicular}\PY{o}{.}\PY{n}{x} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{k}{return} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ponto\PYZus{}medio}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{env1}\PY{p}{,} \PY{n}{env2}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{m} \PY{o}{=} \PY{n}{vetor\PYZus{}direcao\PYZus{}perpendicular}\PY{o}{.}\PY{n}{y} \PY{o}{/} \PY{n}{vetor\PYZus{}direcao\PYZus{}perpendicular}\PY{o}{.}\PY{n}{x}
        \PY{n}{b} \PY{o}{=} \PY{n}{ponto\PYZus{}medio}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZhy{}} \PY{n}{m} \PY{o}{*} \PY{n}{ponto\PYZus{}medio}\PY{o}{.}\PY{n}{x}
        \PY{k}{return} \PY{n}{m}\PY{p}{,} \PY{n}{b}\PY{p}{,} \PY{n}{env1}\PY{p}{,} \PY{n}{env2}

\PY{k}{def} \PY{n+nf}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{pontos1}\PY{p}{,} \PY{n}{pontos2}\PY{p}{)}\PY{p}{:}
    \PY{n}{resultado} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{pontos1}\PY{p}{,} \PY{n}{pontos2}\PY{p}{)}

    \PY{k}{if} \PY{n}{resultado} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{k}{return} \PY{k+kc}{False}

    \PY{n}{modelo}\PY{p}{,} \PY{n}{b}\PY{p}{,} \PY{n}{env1}\PY{p}{,} \PY{n}{env2} \PY{o}{=} \PY{n}{resultado}

    \PY{n}{ponto1}\PY{p}{,} \PY{n}{ponto2} \PY{o}{=} \PY{n}{encontrar\PYZus{}pontos\PYZus{}mais\PYZus{}proximos}\PY{p}{(}\PY{n}{env1}\PY{p}{,} \PY{n}{env2}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{fill}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{y} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{fill}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env2}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{y} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env2}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{p}{[}\PY{n}{env1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{y} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{p}{[}\PY{n}{env1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env2} \PY{o}{+} \PY{p}{[}\PY{n}{env2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{y} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env2} \PY{o}{+} \PY{p}{[}\PY{n}{env2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{n}{ponto1}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{ponto2}\PY{o}{.}\PY{n}{x}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{ponto1}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{ponto2}\PY{o}{.}\PY{n}{y}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{k}{if} \PY{n}{modelo} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{b}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Modelo Linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{m} \PY{o}{=} \PY{n}{modelo}
        \PY{n}{x\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{n+nb}{min}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{n}{env2}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{n}{env2}\PY{p}{]}\PY{p}{)}\PY{p}{]}
        \PY{n}{y\PYZus{}vals} \PY{o}{=} \PY{p}{[}\PY{n}{m}\PY{o}{*}\PY{n}{x}\PY{o}{+}\PY{n}{b} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{x\PYZus{}vals}\PY{p}{]}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}vals}\PY{p}{,} \PY{n}{y\PYZus{}vals}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Modelo Linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Ajuste a escala dos eixos x e y conforme necessário}
    \PY{c+c1}{\PYZsh{} Defina os limites x e y para ajustar a escala do gráfico}
    \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{n+nb}{min}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{n}{env2}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{x} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{n}{env2}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{n+nb}{min}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{y} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{n}{env2}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{p}{[}\PY{n}{p}\PY{o}{.}\PY{n}{y} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{env1} \PY{o}{+} \PY{n}{env2}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

    \PY{k}{return} \PY{k+kc}{True}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{gerar-pontos-aleatuxf3rios-para-ambas-as-classes-para-testar-novamente}{%
\subsubsection{Gerar pontos aleatórios para ambas as classes para testar
novamente}\label{gerar-pontos-aleatuxf3rios-para-ambas-as-classes-para-testar-novamente}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Gerar pontos aleatórios para testar}
\PY{n}{classe\PYZus{}1\PYZus{}random} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{]}
\PY{n}{classe\PYZus{}2\PYZus{}random} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{,} \PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{]}

\PY{n}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{classe\PYZus{}1\PYZus{}random}\PY{p}{,} \PY{n}{classe\PYZus{}2\PYZus{}random}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Os dados não são linearmente separáveis.
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
False
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{aplicauxe7uxe3o-do-pca-anuxe1lise-de-componentes-principais}{%
\subsection{Aplicação do PCA (Análise de Componentes
Principais)}\label{aplicauxe7uxe3o-do-pca-anuxe1lise-de-componentes-principais}}

O código acima define uma função que aplica a Análise de Componentes
Principais (PCA) a um conjunto de dados, reduzindo suas dimensões para
um número especificado. A função funciona da seguinte maneira:

\hypertarget{funuxe7uxe3o-apply_pcadata-n_components2}{%
\subsubsection{\texorpdfstring{Função:
\texttt{apply\_pca(data,\ n\_components=2)}}{Função: apply\_pca(data, n\_components=2)}}\label{funuxe7uxe3o-apply_pcadata-n_components2}}

\hypertarget{entrada}{%
\paragraph{\texorpdfstring{\textbf{Entrada:}}{Entrada:}}\label{entrada}}

\begin{itemize}
\tightlist
\item
  \texttt{data}: O conjunto de dados original que você deseja reduzir em
  dimensão.
\item
  \texttt{n\_components}: O número de componentes principais para o qual
  você deseja reduzir o conjunto de dados. O valor padrão é 2.
\end{itemize}

\hypertarget{processo}{%
\paragraph{\texorpdfstring{\textbf{Processo:}}{Processo:}}\label{processo}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Normalização}:

  \begin{itemize}
  \tightlist
  \item
    Antes de aplicar PCA, é essencial que os dados sejam normalizados.
    Isso garante que todas as características tenham igual importância
    durante a redução da dimensionalidade.
  \item
    Utiliza-se a classe \texttt{StandardScaler} do scikit-learn para
    normalizar os dados de modo que tenham média 0 e desvio padrão 1.
  \end{itemize}
\item
  \textbf{Aplicação do PCA}:

  \begin{itemize}
  \tightlist
  \item
    Utiliza-se a classe \texttt{PCA} do scikit-learn para realizar a
    redução da dimensionalidade.
  \item
    A quantidade de componentes é definida pelo parâmetro
    \texttt{n\_components}.
  \end{itemize}
\item
  \textbf{Formatação da Saída}:

  \begin{itemize}
  \tightlist
  \item
    Os dados reduzidos são convertidos de volta para um DataFrame do
    pandas com nomes de colunas correspondentes aos componentes
    principais (por exemplo, ``Componente 1'', ``Componente 2'',
    \ldots{}).
  \end{itemize}
\end{enumerate}

\hypertarget{sauxedda}{%
\paragraph{\texorpdfstring{\textbf{Saída:}}{Saída:}}\label{sauxedda}}

\begin{itemize}
\tightlist
\item
  Retorna um DataFrame contendo os dados transformados com suas
  principais componentes.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{p}{,} \PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} Normaliza os dados}
    \PY{n}{scaler} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
    \PY{n}{normalized\PYZus{}data} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Aplica PCA}
    \PY{n}{pca} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{n}{n\PYZus{}components}\PY{p}{)}
    \PY{n}{reduced\PYZus{}data} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{normalized\PYZus{}data}\PY{p}{)}

    \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{reduced\PYZus{}data}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+sa}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente }\PY{l+s+si}{\PYZob{}}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s1}{\PYZsq{}} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{p}{)}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{cuxe1lculo-de-muxe9tricas}{%
\subsection{Cálculo de métricas}\label{cuxe1lculo-de-muxe9tricas}}

Após a conclusão dos algoritmos para a implementação do modelo linear,
será necessário o cálculo das métricas para avaliar o desempenho do
classificador. Para isso, o código abaixo foi implementado, ele é útil
para analisar e compreender a distribuição e classificação de pontos em
um espaço 2D, calculando as metricas de
\texttt{precisão,\ revocação\ e\ f1-escore}.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{prever}\PY{p}{(}\PY{n}{modelo}\PY{p}{,} \PY{n}{ponto}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{p}{)}\PY{p}{:}
    \PY{n}{m}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{modelo}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}
    \PY{k}{if} \PY{n}{ponto}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZgt{}} \PY{n}{m} \PY{o}{*} \PY{n}{ponto}\PY{o}{.}\PY{n}{x} \PY{o}{+} \PY{n}{c}\PY{p}{:}
        \PY{k}{return} \PY{n}{positive\PYZus{}label}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{return} \PY{n}{negative\PYZus{}label}

\PY{k}{def} \PY{n+nf}{calcular\PYZus{}metricas}\PY{p}{(}\PY{n}{label\PYZus{}name}\PY{p}{,} \PY{n}{test}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{p}{)}\PY{p}{:}
    \PY{n}{verdadeiros} \PY{o}{=} \PY{n}{test}\PY{p}{[}\PY{n}{label\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
    \PY{n}{previstos} \PY{o}{=} \PY{p}{[}\PY{n}{prever}\PY{p}{(}\PY{n}{modelo}\PY{p}{,} \PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{test}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

    \PY{n}{tp} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{l+m+mi}{1} \PY{k}{for} \PY{n}{v}\PY{p}{,} \PY{n}{p} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{verdadeiros}\PY{p}{,} \PY{n}{previstos}\PY{p}{)} \PY{k}{if} \PY{n}{v} \PY{o}{==} \PY{n}{positive\PYZus{}label} \PY{o+ow}{and} \PY{n}{p} \PY{o}{==} \PY{n}{positive\PYZus{}label}\PY{p}{)}
    \PY{n}{fp} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{l+m+mi}{1} \PY{k}{for} \PY{n}{v}\PY{p}{,} \PY{n}{p} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{verdadeiros}\PY{p}{,} \PY{n}{previstos}\PY{p}{)} \PY{k}{if} \PY{n}{v} \PY{o}{==} \PY{n}{negative\PYZus{}label} \PY{o+ow}{and} \PY{n}{p} \PY{o}{==} \PY{n}{positive\PYZus{}label}\PY{p}{)}
    \PY{n}{fn} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{l+m+mi}{1} \PY{k}{for} \PY{n}{v}\PY{p}{,} \PY{n}{p} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{verdadeiros}\PY{p}{,} \PY{n}{previstos}\PY{p}{)} \PY{k}{if} \PY{n}{v} \PY{o}{==} \PY{n}{positive\PYZus{}label} \PY{o+ow}{and} \PY{n}{p} \PY{o}{==} \PY{n}{negative\PYZus{}label}\PY{p}{)}

    \PY{n}{precisao} \PY{o}{=} \PY{n}{tp} \PY{o}{/} \PY{p}{(}\PY{n}{tp} \PY{o}{+} \PY{n}{fp}\PY{p}{)} \PY{k}{if} \PY{n}{tp} \PY{o}{+} \PY{n}{fp} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}
    \PY{n}{revocacao} \PY{o}{=} \PY{n}{tp} \PY{o}{/} \PY{p}{(}\PY{n}{tp} \PY{o}{+} \PY{n}{fn}\PY{p}{)} \PY{k}{if} \PY{n}{tp} \PY{o}{+} \PY{n}{fn} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}
    \PY{n}{f1} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(}\PY{n}{precisao} \PY{o}{*} \PY{n}{revocacao}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{precisao} \PY{o}{+} \PY{n}{revocacao}\PY{p}{)} \PY{k}{if} \PY{p}{(}\PY{n}{precisao} \PY{o}{+} \PY{n}{revocacao}\PY{p}{)} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}

    \PY{k}{return} \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1}


\PY{k}{def} \PY{n+nf}{plotar\PYZus{}classificacao}\PY{p}{(}\PY{n}{pontos1}\PY{p}{,} \PY{n}{pontos2}\PY{p}{)}\PY{p}{:}
    \PY{c+c1}{\PYZsh{} Extrair coordenadas x e y dos pontos para plotagem}
    \PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{pontos1}\PY{p}{,} \PY{n}{pontos2}\PY{p}{)}
    \PY{k}{if} \PY{n}{modelo} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
        \PY{k}{return} \PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}

    \PY{n}{x1}\PY{p}{,} \PY{n}{y1} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{p}{[}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{p}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{pontos1}\PY{p}{]}\PY{p}{)}
    \PY{n}{x2}\PY{p}{,} \PY{n}{y2} \PY{o}{=} \PY{n+nb}{zip}\PY{p}{(}\PY{o}{*}\PY{p}{[}\PY{p}{(}\PY{n}{p}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{p}\PY{o}{.}\PY{n}{y}\PY{p}{)} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{pontos2}\PY{p}{]}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Plotar os pontos}
    \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x1}\PY{p}{,} \PY{n}{y1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Classe 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x2}\PY{p}{,} \PY{n}{y2}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Classe 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{} Plotar a reta do modelo}
    \PY{k}{if} \PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{n}{plt}\PY{o}{.}\PY{n}{axvline}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Reta do Modelo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} Criando uma sequência de valores x para a reta}
        \PY{n}{x\PYZus{}reta} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{min}\PY{p}{(}\PY{n}{x1} \PY{o}{+} \PY{n}{x2}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{x1} \PY{o}{+} \PY{n}{x2}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
        \PY{n}{y\PYZus{}reta} \PY{o}{=} \PY{p}{[}\PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{n}{x} \PY{o}{+} \PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{x\PYZus{}reta}\PY{p}{]}

        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x\PYZus{}reta}\PY{p}{,} \PY{n}{y\PYZus{}reta}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Reta do Modelo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{X}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Classificação de Pontos com Modelo Linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{k+kc}{True}\PY{p}{)}
    \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}


\PY{k}{def} \PY{n+nf}{classificar\PYZus{}pontosIris}\PY{p}{(}\PY{n}{ponto}\PY{p}{,} \PY{n}{modelo}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{k}{return} \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{ponto}\PY{o}{.}\PY{n}{x} \PY{o}{\PYZgt{}} \PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{else} \PY{l+m+mi}{2}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{y\PYZus{}modelo} \PY{o}{=} \PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{*} \PY{n}{ponto}\PY{o}{.}\PY{n}{x} \PY{o}{+} \PY{n}{modelo}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{k}{return} \PY{l+m+mi}{1} \PY{k}{if} \PY{n}{ponto}\PY{o}{.}\PY{n}{y} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{y\PYZus{}modelo} \PY{k}{else} \PY{l+m+mi}{2}

\PY{k}{def} \PY{n+nf}{calcular\PYZus{}metricasIris}\PY{p}{(}\PY{n}{pontos1}\PY{p}{,} \PY{n}{pontos2}\PY{p}{,} \PY{n}{modelo}\PY{p}{)}\PY{p}{:}
    \PY{n}{VP} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{l+m+mi}{1} \PY{k}{for} \PY{n}{ponto} \PY{o+ow}{in} \PY{n}{pontos1} \PY{k}{if} \PY{n}{classificar\PYZus{}pontosIris}\PY{p}{(}\PY{n}{ponto}\PY{p}{,} \PY{n}{modelo}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{FN} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{pontos1}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{VP}

    \PY{n}{VN} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{l+m+mi}{1} \PY{k}{for} \PY{n}{ponto} \PY{o+ow}{in} \PY{n}{pontos2} \PY{k}{if} \PY{n}{classificar\PYZus{}pontosIris}\PY{p}{(}\PY{n}{ponto}\PY{p}{,} \PY{n}{modelo}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{)}
    \PY{n}{FP} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{pontos2}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{VN}

    \PY{n}{precisao} \PY{o}{=} \PY{n}{VP} \PY{o}{/} \PY{p}{(}\PY{n}{VP} \PY{o}{+} \PY{n}{FP}\PY{p}{)} \PY{k}{if} \PY{p}{(}\PY{n}{VP} \PY{o}{+} \PY{n}{FP}\PY{p}{)} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}
    \PY{n}{revocacao} \PY{o}{=} \PY{n}{VP} \PY{o}{/} \PY{p}{(}\PY{n}{VP} \PY{o}{+} \PY{n}{FN}\PY{p}{)} \PY{k}{if} \PY{p}{(}\PY{n}{VP} \PY{o}{+} \PY{n}{FN}\PY{p}{)} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}
    \PY{n}{f1\PYZus{}score} \PY{o}{=} \PY{l+m+mi}{2} \PY{o}{*} \PY{p}{(}\PY{n}{precisao} \PY{o}{*} \PY{n}{revocacao}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{precisao} \PY{o}{+} \PY{n}{revocacao}\PY{p}{)} \PY{k}{if} \PY{p}{(}\PY{n}{precisao} \PY{o}{+} \PY{n}{revocacao}\PY{p}{)} \PY{o}{!=} \PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{0}

    \PY{k}{return} \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1\PYZus{}score}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{testando-os-algoritmos-com-o-dataset-iris}{%
\subsection{Testando os algoritmos com o dataset
IRIS}\label{testando-os-algoritmos-com-o-dataset-iris}}

Abaixo terá uma sequência de passos que fizemos para que de fato
utilizar todos os algoritmos implementados e montar o classificador como
um todo, feito sem o uso de PCA para explicitar a diferença ao não
usá-lo.

    Import DataSet Iris

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{ucimlrepo} \PY{k+kn}{import} \PY{n}{fetch\PYZus{}ucirepo}

\PY{c+c1}{\PYZsh{} fetch dataset}
\PY{n}{iris} \PY{o}{=} \PY{n}{fetch\PYZus{}ucirepo}\PY{p}{(}\PY{n+nb}{id}\PY{o}{=}\PY{l+m+mi}{53}\PY{p}{)}

\PY{c+c1}{\PYZsh{} data (as pandas dataframes)}
\PY{n}{x} \PY{o}{=} \PY{n}{iris}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{features}
\PY{n}{y} \PY{o}{=} \PY{n}{iris}\PY{o}{.}\PY{n}{data}\PY{o}{.}\PY{n}{targets}

\PY{n}{irisData} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{irisData}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   sepal length  sepal width  petal length  petal width        class
0           5.1          3.5           1.4          0.2  Iris-setosa
1           4.9          3.0           1.4          0.2  Iris-setosa
2           4.7          3.2           1.3          0.2  Iris-setosa
3           4.6          3.1           1.5          0.2  Iris-setosa
4           5.0          3.6           1.4          0.2  Iris-setosa
\end{Verbatim}
\end{tcolorbox}
        
    Separando em grupos de \texttt{teste(30\%)} e \texttt{treino(70\%)} E
separando as duas classes que iremos utilizar para os cálculos
\texttt{Iris-versicolor} e \texttt{Iris-setosa}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{irisTest} \PY{o}{=} \PY{n}{irisData}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac} \PY{o}{=} \PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{irisTrain} \PY{o}{=} \PY{n}{irisData}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{irisTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{n}{versicolor} \PY{o}{=} \PY{n}{irisTrain}\PY{p}{[}\PY{n}{irisTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iris\PYZhy{}versicolor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{versicolor} \PY{o}{=} \PY{n}{versicolor}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sepal width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petal width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{versicolor}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}

\PY{n}{setosa}\PY{o}{=} \PY{n}{irisTrain}\PY{p}{[}\PY{n}{irisTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iris\PYZhy{}setosa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{setosa} \PY{o}{=} \PY{n}{setosa}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sepal width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petal width}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{setosa}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   sepal length  petal length        class
0           5.1           1.4  Iris-setosa
2           4.7           1.3  Iris-setosa
4           5.0           1.4  Iris-setosa
5           5.4           1.7  Iris-setosa
8           4.4           1.4  Iris-setosa
\end{Verbatim}
\end{tcolorbox}
        
    Rodando o algoritmo de Graham Scan para gerar as duas envoltorias
referentes aos pontos que foram separados.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pointsVersicolor} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sepal length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petal length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{versicolor}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{n}{versicolorEnv} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{pointsVersicolor}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{pointsVersicolor}\PY{p}{,} \PY{n}{versicolorEnv}\PY{p}{)}

\PY{n}{pointsSetosa} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sepal length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{petal length}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{setosa}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{setosaEnv} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{pointsSetosa}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{pointsSetosa}\PY{p}{,} \PY{n}{setosaEnv}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_40_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_40_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Verificando a separabilidade linear dos pontos, por meio de suas
envoltórias.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{versicolorEnv}\PY{p}{,} \PY{n}{setosaEnv}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{pointsVersicolor}\PY{p}{,} \PY{n}{pointsSetosa}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_42_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Após verificar a separabilidade linear, rodamos o algoritmo de
construção de modelo, onde ele pega os vertices mais próximos das
envoltórias e traça uma reta (linha tracejada verde). A partir dessa
reta, traça-se uma nova reta(azul) a partir do ponto médio da linha
verde, a inclinação da reta é proporcional a precisão do modelo, quanto
melhor for a precisão ``mais perpendicular'' ela fica.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{pointsVersicolor}\PY{p}{,} \PY{n}{pointsSetosa}\PY{p}{)}
\PY{n}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{pointsVersicolor}\PY{p}{,} \PY{n}{pointsSetosa}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_44_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
True
\end{Verbatim}
\end{tcolorbox}
        
    Representação dos cáculos das métricas

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricasIris}\PY{p}{(}\PY{n}{pointsVersicolor}\PY{p}{,} \PY{n}{pointsSetosa}\PY{p}{,} \PY{n}{modelo}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Precisão: 1.00
Revocação: 1.00
F1-score: 1.00
    \end{Verbatim}

    \hypertarget{avaliauxe7uxe3o-de-precisuxe3o-em-classificauxe7uxe3o-de-dados-com-10-datasets}{%
\section{Avaliação de Precisão em Classificação de Dados com 10
Datasets}\label{avaliauxe7uxe3o-de-precisuxe3o-em-classificauxe7uxe3o-de-dados-com-10-datasets}}

Neste estudo, conduziremos uma análise abrangente da precisão em
classificação de dados em 10 conjuntos de dados distintos. O objetivo
principal é aplicar um modelo de classificação linear a cada um dos 10
datasets e avaliar a sua eficácia. A abordagem adotada inclui a
utilização de Análise de Componentes Principais (PCA), cálculo do casco
convexo, verificação da separabilidade linear, construção de modelos
lineares e a medição de métricas de desempenho.

Os passos principais deste estudo incluem: 1. Aplicação do PCA para
redução de dimensionalidade nos conjuntos de dados. 2. Divisão dos dados
em conjuntos de treinamento e teste. 3. Cálculo do casco convexo para as
classes relevantes em cada conjunto de dados. 4. Verificação da
separabilidade linear entre as classes. 5. Construção de modelos de
classificação linear. 6. Avaliação do desempenho dos modelos por meio da
medição de métricas como precisão, revocação e F1-score.

Os resultados obtidos serão apresentados de forma clara e concisa para
cada conjunto de dados, destacando a precisão alcançada em cada caso.
Este estudo visa fornecer insights sobre a capacidade de classificação
em uma variedade de cenários de dados e demonstrar como a aplicação de
técnicas como PCA e casco convexo pode influenciar o desempenho dos
modelos.

Vamos agora prosseguir com a execução do modelo nos 10 datasets e
analisar os resultados obtidos.

    \hypertarget{sobre-o-dataset-iris}{%
\subsection{Sobre o Dataset ``Iris''}\label{sobre-o-dataset-iris}}

O dataset ``Iris'' é um conjunto de dados amplamente reconhecido e
utilizado na área de Aprendizado de Máquina e Estatística. Consiste em
150 amostras de três espécies de flores do gênero Iris, sendo elas: Iris
setosa, Iris virginica e Iris versicolor. Cada amostra contém quatro
atributos (ou características) relacionados às dimensões das pétalas e
sépalas da flor, em centímetros.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Aplicando PCA}
\PY{n}{irisPCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{irisData}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{irisPCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{irisData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{irisTest} \PY{o}{=} \PY{n}{irisPCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac} \PY{o}{=} \PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{irisTrain} \PY{o}{=} \PY{n}{irisPCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{irisTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}class\PYZsq{}}
\PY{n}{irisTrain0} \PY{o}{=} \PY{n}{irisTrain}\PY{p}{[}\PY{n}{irisTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iris\PYZhy{}setosa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{irisTrain1} \PY{o}{=} \PY{n}{irisTrain}\PY{p}{[}\PY{n}{irisTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iris\PYZhy{}versicolor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Convertendo para pontos}
\PY{n}{irisTrain0Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{irisTrain0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{irisTrain1Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{irisTrain1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando o casco convexo}
\PY{n}{irisTrain0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{irisTrain0Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{irisTrain0Pts}\PY{p}{,} \PY{n}{irisTrain0Env}\PY{p}{)}

\PY{n}{irisTrain1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{irisTrain1Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{irisTrain1Pts}\PY{p}{,} \PY{n}{irisTrain1Env}\PY{p}{)}

\PY{n}{separavel} \PY{o}{=} \PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{irisTrain0Env}\PY{p}{,} \PY{n}{irisTrain1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{irisTrain0Pts}\PY{p}{,} \PY{n}{irisTrain1Pts}\PY{p}{)}

\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{irisTrain0Pts}\PY{p}{,} \PY{n}{irisTrain1Pts}\PY{p}{)}
\PY{k}{if} \PY{p}{(}\PY{n}{modelo}\PY{p}{)}\PY{p}{:}
    \PY{n}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{irisTrain0Pts}\PY{p}{,} \PY{n}{irisTrain1Pts}\PY{p}{)}
    \PY{n}{label\PYZus{}iris} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{class}\PY{l+s+s1}{\PYZsq{}}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{n}{label\PYZus{}iris}\PY{p}{,} \PY{n}{irisTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iris\PYZhy{}setosa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Iris\PYZhy{}versicolor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação : }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_49_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_49_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_49_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Precisão: 1.00
Revocação : 0.92
F1-score: 0.96
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-digits}{%
\subsection{Sobre o Dataset ``Digits''}\label{sobre-o-dataset-digits}}

O dataset ``Digits'' é um conjunto de dados amplamente utilizado na área
de Aprendizado de Máquina e Reconhecimento de Padrões. Ele é composto
por imagens em escala de cinza de dígitos escritos à mão, variando de 0
a 9. Cada imagem possui uma resolução de 8x8 pixels, resultando em 64
atributos (ou características) para cada exemplo. Este dataset é um
recurso fundamental para a comunidade de Aprendizado de Máquina,
ajudando a construir e testar modelos de classificação, especialmente em
tarefas de reconhecimento de dígitos manuscritos.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{load\PYZus{}digits}

\PY{n}{digits} \PY{o}{=} \PY{n}{load\PYZus{}digits}\PY{p}{(}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{digits}\PY{o}{.}\PY{n}{data}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{digits}\PY{o}{.}\PY{n}{target}

\PY{c+c1}{\PYZsh{} Aplicando PCA}
\PY{n}{digitsPCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{digitsPCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{digitsTest} \PY{o}{=} \PY{n}{digitsPCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac} \PY{o}{=} \PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{digitsTrain} \PY{o}{=} \PY{n}{digitsPCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{digitsTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{digitsTrain6} \PY{o}{=} \PY{n}{digitsTrain}\PY{p}{[}\PY{n}{digitsTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{6}\PY{p}{]}
\PY{n}{digitsTrain7} \PY{o}{=} \PY{n}{digitsTrain}\PY{p}{[}\PY{n}{digitsTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{7}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Convertendo para pontos}
\PY{n}{digitsTrain6Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{digitsTrain6}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{digitsTrain7Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{digitsTrain7}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando o casco convexo}
\PY{n}{digitsTrain6Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{digitsTrain6Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{digitsTrain6Pts}\PY{p}{,} \PY{n}{digitsTrain6Env}\PY{p}{)}

\PY{n}{digitsTrain7Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{digitsTrain7Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{digitsTrain7Pts}\PY{p}{,} \PY{n}{digitsTrain7Env}\PY{p}{)}

\PY{n}{separavel} \PY{o}{=} \PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{digitsTrain6Env}\PY{p}{,} \PY{n}{digitsTrain7Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{digitsTrain6Pts}\PY{p}{,} \PY{n}{digitsTrain7Pts}\PY{p}{)}

\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{digitsTrain6Pts}\PY{p}{,} \PY{n}{digitsTrain7Pts}\PY{p}{)}
\PY{k}{if} \PY{p}{(}\PY{n}{modelo}\PY{p}{)}\PY{p}{:}
    \PY{n}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{digitsTrain6Pts}\PY{p}{,} \PY{n}{digitsTrain7Pts}\PY{p}{)}
    \PY{n}{label\PYZus{}digits} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{n}{label\PYZus{}digits}\PY{p}{,} \PY{n}{digitsTrain}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Note que corrigi os labels}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_51_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_51_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_51_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Precisão: 0.39
Revocação: 0.59
F1-score: 0.47
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-olivetti-faces}{%
\subsection{Sobre o Dataset ``Olivetti
Faces''}\label{sobre-o-dataset-olivetti-faces}}

O dataset ``Olivetti Faces'' é um conjunto de dados amplamente
reconhecido e utilizado na área de Visão Computacional e Aprendizado de
Máquina. Esse dataset é notável por sua ênfase em reconhecimento facial
e consiste em uma coleção de imagens de faces de 40 indivíduos
diferentes. Cada pessoa é representada em 10 imagens distintas,
totalizando 400 imagens no conjunto de dados. Sua variedade de faces,
resolução das imagens e disponibilidade ampla o tornam uma escolha comum
para avaliação de algoritmos de reconhecimento facial e visão
computacional.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{fetch\PYZus{}olivetti\PYZus{}faces}

\PY{n}{faces} \PY{o}{=} \PY{n}{fetch\PYZus{}olivetti\PYZus{}faces}\PY{p}{(}\PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{faces}\PY{o}{.}\PY{n}{data}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{faces}\PY{o}{.}\PY{n}{target}

\PY{c+c1}{\PYZsh{} Aplicando PCA}
\PY{n}{facesPCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{facesPCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{n}{facesTest} \PY{o}{=} \PY{n}{facesPCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac} \PY{o}{=} \PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{facesTrain} \PY{o}{=} \PY{n}{facesPCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{facesTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{facesTrain0} \PY{o}{=} \PY{n}{facesTrain}\PY{p}{[}\PY{n}{facesTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{facesTrain1} \PY{o}{=} \PY{n}{facesTrain}\PY{p}{[}\PY{n}{facesTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Convertendo para pontos}
\PY{n}{facesTrain0Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{facesTrain0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{facesTrain1Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{facesTrain1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando o casco convexo}
\PY{n}{facesTrain0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{facesTrain0Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{facesTrain0Pts}\PY{p}{,} \PY{n}{facesTrain0Env}\PY{p}{)}

\PY{n}{facesTrain1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{facesTrain1Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{facesTrain1Pts}\PY{p}{,} \PY{n}{facesTrain1Env}\PY{p}{)}

\PY{n}{separavel} \PY{o}{=} \PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{facesTrain0Env}\PY{p}{,} \PY{n}{facesTrain1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{facesTrain0Pts}\PY{p}{,} \PY{n}{facesTrain1Pts}\PY{p}{)}

\PY{k}{if} \PY{n}{separavel}\PY{p}{:}
    \PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{facesTrain0Pts}\PY{p}{,} \PY{n}{facesTrain1Pts}\PY{p}{)}
    \PY{n}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{facesTrain0Pts}\PY{p}{,} \PY{n}{facesTrain1Pts}\PY{p}{)}

    \PY{n}{label\PYZus{}faces} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{n}{label\PYZus{}faces}\PY{p}{,} \PY{n}{facesTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_53_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_53_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_53_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_53_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Precisão: 0.50
Revocação: 0.67
F1-score: 0.57
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-breast-cancer-cuxe2ncer-de-mama}{%
\subsection{Sobre o Dataset ``Breast Cancer'' (Câncer de
Mama)}\label{sobre-o-dataset-breast-cancer-cuxe2ncer-de-mama}}

O dataset ``Breast Cancer'' (Câncer de Mama) é uma referência na área de
Aprendizado de Máquina e Medicina, sendo utilizado para tarefas de
diagnóstico de câncer de mama. Ele contém informações detalhadas sobre
características de tumores de mama, permitindo a construção de modelos
de classificação para determinar se um tumor é benigno ou maligno. Este
dataset uma ferramenta crucial no campo da medicina e Aprendizado de
Máquina, permitindo o desenvolvimento de modelos de classificação para
auxiliar no diagnóstico de câncer de mama e, assim, contribuir para a
saúde e bem-estar das pacientes.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{load\PYZus{}breast\PYZus{}cancer}

\PY{c+c1}{\PYZsh{} Carregando os dados}
\PY{n}{cancer} \PY{o}{=} \PY{n}{load\PYZus{}breast\PYZus{}cancer}\PY{p}{(}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{cancer}\PY{o}{.}\PY{n}{data}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Adicionando uma coluna com os rótulos}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{cancer}\PY{o}{.}\PY{n}{target}

\PY{n}{cancerPCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{cancerPCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} Adicionando o rótulo de volta após o PCA}

\PY{n}{cancerTest} \PY{o}{=} \PY{n}{cancerPCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac} \PY{o}{=} \PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{cancerTrain} \PY{o}{=} \PY{n}{cancerPCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{cancerTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{cancerPCA0} \PY{o}{=} \PY{n}{cancerTrain}\PY{p}{[}\PY{n}{cancerTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{cancerPCA1} \PY{o}{=} \PY{n}{cancerTrain}\PY{p}{[}\PY{n}{cancerTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Convertendo para pontos}
\PY{n}{cancerPCA0Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{cancerPCA0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{cancerPCA1Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{cancerPCA1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Calculando e Plotando a envoltória convexa}
\PY{n}{cancerPCA0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{cancerPCA0Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{cancerPCA0Pts}\PY{p}{,} \PY{n}{cancerPCA0Env}\PY{p}{)}

\PY{n}{cancerPCA1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{cancerPCA1Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{cancerPCA1Pts}\PY{p}{,} \PY{n}{cancerPCA1Env}\PY{p}{)}

\PY{n}{separavel} \PY{o}{=} \PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{cancerPCA0Env}\PY{p}{,} \PY{n}{cancerPCA1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{cancerPCA0Pts}\PY{p}{,} \PY{n}{cancerPCA1Pts}\PY{p}{)}

\PY{k}{if} \PY{n}{separavel}\PY{p}{:}
    \PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{cancerPCA0Pts}\PY{p}{,} \PY{n}{cancerPCA1Pts}\PY{p}{)}
    \PY{n}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{cancerPCA0Pts}\PY{p}{,} \PY{n}{cancerPCA1Pts}\PY{p}{)}

    \PY{n}{label\PYZus{}cancer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{n}{label\PYZus{}cancer}\PY{p}{,} \PY{n}{cancerTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_55_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_55_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_55_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{sobre-o-dataset-load-wine-conjunto-de-dados-do-vinho}{%
\subsection{Sobre o Dataset ``Load Wine'' (Conjunto de Dados do
Vinho)}\label{sobre-o-dataset-load-wine-conjunto-de-dados-do-vinho}}

O dataset ``Load Wine,'' também conhecido como ``Conjunto de Dados do
Vinho,'' é um conjunto de dados amplamente utilizado no campo de Análise
de Vinhos e Aprendizado de Máquina. Ele contém informações sobre
diversas características químicas de vinhos produzidos a partir de três
diferentes cultivares de uvas na região da Itália. Este conjunto de
dados é frequentemente usado para tarefas de classificação e análise de
vinhos. Sua representação das características químicas dos vinhos
italianos contribui para o desenvolvimento de modelos de classificação
precisos e aprimora a compreensão das variações nos vinhos produzidos na
região.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{load\PYZus{}wine}

\PY{c+c1}{\PYZsh{} Carregando os dados}
\PY{n}{wine} \PY{o}{=} \PY{n}{load\PYZus{}wine}\PY{p}{(}\PY{p}{)}
\PY{n}{dataWine} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{wine}\PY{o}{.}\PY{n}{data}\PY{p}{)}

\PY{n}{dataWine}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{wine}\PY{o}{.}\PY{n}{target}

\PY{n}{winePCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{dataWine}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{winePCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{dataWine}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}


\PY{c+c1}{\PYZsh{} Dividindo os dados em conjuntos de treinamento e teste}
\PY{n}{wineTest} \PY{o}{=} \PY{n}{winePCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{wineTrain} \PY{o}{=} \PY{n}{winePCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{wineTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{winePCA0} \PY{o}{=} \PY{n}{wineTrain}\PY{p}{[}\PY{n}{wineTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}
\PY{n}{winePCA1} \PY{o}{=} \PY{n}{wineTrain}\PY{p}{[}\PY{n}{wineTrain}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Convertendo para pontos}
\PY{n}{winePCA0Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{winePCA0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{winePCA1Pts} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{winePCA1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Calculando e Plotando a envoltória convexa}
\PY{n}{winePCA0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{winePCA0Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{winePCA0Pts}\PY{p}{,} \PY{n}{winePCA0Env}\PY{p}{)}

\PY{n}{winePCA1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{winePCA1Pts}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{winePCA1Pts}\PY{p}{,} \PY{n}{winePCA1Env}\PY{p}{)}

\PY{n}{separavel} \PY{o}{=} \PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{winePCA0Env}\PY{p}{,} \PY{n}{winePCA1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{winePCA0Pts}\PY{p}{,} \PY{n}{winePCA1Pts}\PY{p}{)}

\PY{k}{if} \PY{n}{separavel}\PY{p}{:}
    \PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{winePCA0Pts}\PY{p}{,} \PY{n}{winePCA1Pts}\PY{p}{)}
    \PY{n}{plot\PYZus{}modelo}\PY{p}{(}\PY{n}{winePCA0Pts}\PY{p}{,} \PY{n}{winePCA1Pts}\PY{p}{)}
    \PY{n}{label\PYZus{}wine} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}

    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{n}{label\PYZus{}wine}\PY{p}{,} \PY{n}{wineTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k}{else}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Os dados não são linearmente separáveis.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_57_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_57_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_57_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_57_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Precisão: 0.94
Revocação: 1.00
F1-score: 0.97
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-load-diabetes-conjunto-de-dados-diabetes}{%
\subsection{Sobre o Dataset ``Load Diabetes'' (Conjunto de Dados
Diabetes)}\label{sobre-o-dataset-load-diabetes-conjunto-de-dados-diabetes}}

O dataset ``Load Diabetes,'' também conhecido como ``Conjunto de Dados
Diabetes,'' é uma ferramenta essencial no campo da Aprendizado de
Máquina e Pesquisa Médica. Este conjunto de dados contém informações
relacionadas a pacientes com diabetes e é frequentemente utilizado para
tarefas de regressão e previsão de progressão da doença. Suas
características médicas e disponibilidade pública o tornam uma escolha
comum para a construção de modelos de regressão e estudos clínicos
relacionados ao diabetes.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{load\PYZus{}diabetes}

\PY{n}{diabetes} \PY{o}{=} \PY{n}{load\PYZus{}diabetes}\PY{p}{(}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{diabetes}\PY{o}{.}\PY{n}{data}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Adicione uma coluna com os rótulos}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{diabetes}\PY{o}{.}\PY{n}{target}

\PY{c+c1}{\PYZsh{} Applying PCA for dimensionality reduction}
\PY{n}{diabetesPCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}

\PY{n}{diabetesPCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Dividindo os dados em conjuntos de treinamento e teste}
\PY{n}{diabetesTest} \PY{o}{=} \PY{n}{diabetesPCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{diabetesTrain} \PY{o}{=} \PY{n}{diabetesPCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{diabetesTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Accessing the classes separately based on the \PYZsq{}label\PYZsq{} column}
\PY{n}{diabetesPCA0} \PY{o}{=} \PY{n}{diabetesPCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mf}{90.0}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{diabetesPCA1} \PY{o}{=} \PY{n}{diabetesPCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mf}{72.0}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Convertendo em pontos}
\PY{n}{diabetesPCA0} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{diabetesPCA0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{diabetesPCA1} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{diabetesPCA1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando a envoltória convexa}
\PY{n}{diabetesPCA0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{diabetesPCA0}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{diabetesPCA0}\PY{p}{,} \PY{n}{diabetesPCA0Env}\PY{p}{)}

\PY{n}{diabetesPCA1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{diabetesPCA1}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{diabetesPCA1}\PY{p}{,} \PY{n}{diabetesPCA1Env}\PY{p}{)}

\PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{diabetesPCA0Env}\PY{p}{,} \PY{n}{diabetesPCA1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{diabetesPCA0}\PY{p}{,} \PY{n}{diabetesPCA1}\PY{p}{)}

\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{diabetesPCA0}\PY{p}{,} \PY{n}{diabetesPCA1}\PY{p}{)}

\PY{k}{if} \PY{n}{modelo}\PY{p}{:}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{n}{diabetesTrain}\PY{p}{,} \PY{n}{diabetesTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{l+m+mi}{90}\PY{p}{,} \PY{l+m+mi}{72}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_59_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_59_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_59_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Os dados não são linearmente separáveis.
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-kdd-cup-1999-kdd-cup-99}{%
\subsection{Sobre o Dataset ``KDD Cup 1999'' (KDD Cup
99)}\label{sobre-o-dataset-kdd-cup-1999-kdd-cup-99}}

O dataset ``KDD Cup 1999,'' também conhecido como ``KDD Cup 99
Dataset,'' é uma referência na área de Segurança de Redes e Detecção de
Anomalias. Este conjunto de dados foi criado para a competição KDD Cup
1999, que desafiou os participantes a desenvolver modelos de detecção de
intrusões em redes de computadores. Em resumo, o dataset ``KDD Cup
1999'' é uma ferramenta crítica na área de Segurança de Redes e
cibersegurança. Sua capacidade de representar e identificar ameaças à
segurança de redes torna-o uma escolha comum para o desenvolvimento e
avaliação de sistemas de detecção de intrusões.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{fetch\PYZus{}kddcup99}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{LabelEncoder}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}

\PY{n}{kddcup99} \PY{o}{=} \PY{n}{fetch\PYZus{}kddcup99}\PY{p}{(}\PY{p}{)}
\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{kddcup99}\PY{o}{.}\PY{n}{data}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Adicione uma coluna com os rótulos}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{kddcup99}\PY{o}{.}\PY{n}{target}

\PY{c+c1}{\PYZsh{} Crie uma instância do LabelEncoder}
\PY{n}{label\PYZus{}encoder} \PY{o}{=} \PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Ajuste e transforme os rótulos}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{label\PYZus{}encoder}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Remova as colunas não númericas}
\PY{n}{colunas\PYZus{}a\PYZus{}remover} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]}  \PY{c+c1}{\PYZsh{} Índices das colunas a serem removidas}
\PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{colunas\PYZus{}a\PYZus{}remover}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Use PCA for dimensionality reduction}
\PY{n}{kddcup99PCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}

\PY{n}{kddcup99PCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Dividindo os dados em conjuntos de treinamento e teste}
\PY{n}{kddcup99Test} \PY{o}{=} \PY{n}{kddcup99PCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{kddcup99Train} \PY{o}{=} \PY{n}{kddcup99PCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{kddcup99Test}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acesse as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{kddcup99PCA0} \PY{o}{=} \PY{n}{kddcup99PCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{7}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{kddcup99PCA1} \PY{o}{=} \PY{n}{kddcup99PCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Convertendo em pontos}
\PY{n}{kddcup99PCA0} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{kddcup99PCA0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{kddcup99PCA1} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{kddcup99PCA1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando a envoltória convexa}
\PY{n}{kddcup99PCA0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{kddcup99PCA0}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{kddcup99PCA0}\PY{p}{,} \PY{n}{kddcup99PCA0Env}\PY{p}{)}

\PY{n}{kddcup99PCA1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{kddcup99PCA1}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{kddcup99PCA1}\PY{p}{,} \PY{n}{kddcup99PCA1Env}\PY{p}{)}

\PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{kddcup99PCA0Env}\PY{p}{,} \PY{n}{kddcup99PCA1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{kddcup99PCA0}\PY{p}{,} \PY{n}{kddcup99PCA1}\PY{p}{)}

\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{kddcup99PCA0}\PY{p}{,} \PY{n}{kddcup99PCA1}\PY{p}{)}

\PY{k}{if} \PY{n}{modelo}\PY{p}{:}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{kddcup99Test}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_61_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_61_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_61_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Os dados não são linearmente separáveis.
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-fetch-covtype-cobertura-florestal}{%
\subsection{Sobre o Dataset ``Fetch Covtype'' (Cobertura
Florestal)}\label{sobre-o-dataset-fetch-covtype-cobertura-florestal}}

O dataset ``Fetch Covtype,'' também conhecido como ``Cobertura
Florestal,'' é uma referência na área de Sensoriamento Remoto e
Classificação de Cobertura do Solo. Este conjunto de dados contém
informações sobre a cobertura florestal de diferentes áreas geográficas
nos Estados Unidos e é amplamente utilizado em aplicações de Aprendizado
de Máquina e Sensoriamento Remoto. Por fim, o dataset desempenha um
papel significativo na área de Sensoriamento Remoto, geoespacial e
Aprendizado de Máquina. Sua capacidade de classificar a cobertura do
solo em áreas geográficas auxilia em uma variedade de aplicações,
incluindo monitoramento ambiental e análise geoespacial.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{fetch\PYZus{}covtype}

\PY{n}{covtype} \PY{o}{=} \PY{n}{fetch\PYZus{}covtype}\PY{p}{(}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{covtype}\PY{o}{.}\PY{n}{data}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{covtype}\PY{o}{.}\PY{n}{target}

\PY{c+c1}{\PYZsh{} Aplicando PCA}
\PY{n}{covtypePCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{covtypePCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Dividindo os dados em conjuntos de treinamento e teste}
\PY{n}{covtypeTest} \PY{o}{=} \PY{n}{covtypePCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{covtypeTrain} \PY{o}{=} \PY{n}{covtypePCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{covtypeTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{covtypePCA0} \PY{o}{=} \PY{n}{covtypePCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{covtypePCA1} \PY{o}{=} \PY{n}{covtypePCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Convertendo em pontos}
\PY{n}{covtypePCA0} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{covtypePCA0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{covtypePCA1} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{covtypePCA1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando a envoltória convexa}
\PY{n}{covtypePCA0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{covtypePCA0}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{covtypePCA0}\PY{p}{,} \PY{n}{covtypePCA0Env}\PY{p}{)}

\PY{n}{covtypePCA1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{covtypePCA1}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{covtypePCA1}\PY{p}{,} \PY{n}{covtypePCA1Env}\PY{p}{)}

\PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{covtypePCA0Env}\PY{p}{,} \PY{n}{covtypePCA1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{covtypePCA0}\PY{p}{,} \PY{n}{covtypePCA1}\PY{p}{)}

\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{covtypePCA0}\PY{p}{,} \PY{n}{covtypePCA1}\PY{p}{)}

\PY{k}{if} \PY{n}{modelo}\PY{p}{:}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{covtypeTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_63_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_63_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_63_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Os dados não são linearmente separáveis.
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-fetch-lfw-people-labeled-faces-in-the-wild---pessoas-rotuladas-na-natureza}{%
\subsection{Sobre o Dataset ``Fetch LFW People'' (Labeled Faces in the
Wild - Pessoas Rotuladas na
Natureza)}\label{sobre-o-dataset-fetch-lfw-people-labeled-faces-in-the-wild---pessoas-rotuladas-na-natureza}}

O dataset ``Fetch LFW People,'' também conhecido como ``Labeled Faces in
the Wild,'' é uma coleção amplamente reconhecida de imagens de rostos de
pessoas coletadas de várias fontes da web. Este conjunto de dados é
frequentemente utilizado na área de Reconhecimento Facial e Aprendizado
de Máquina para tarefas de identificação e verificação de rostos. Ele é
uma valiosa coleção de imagens de rostos humanos amplamente utilizada na
área de Reconhecimento Facial e Aprendizado de Máquina. Sua diversidade
de indivíduos e disponibilidade pública o tornam uma escolha comum para
o desenvolvimento e avaliação de sistemas de reconhecimento facial.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{fetch\PYZus{}lfw\PYZus{}people}

\PY{c+c1}{\PYZsh{} Carregando os dados e reduzindo o dataset com intenção de melhorar o desempenho}
\PY{n}{lfw\PYZus{}people} \PY{o}{=} \PY{n}{fetch\PYZus{}lfw\PYZus{}people}\PY{p}{(}\PY{n}{min\PYZus{}faces\PYZus{}per\PYZus{}person}\PY{o}{=}\PY{l+m+mi}{70}\PY{p}{,} \PY{n}{resize}\PY{o}{=}\PY{l+m+mf}{0.4}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{lfw\PYZus{}people}\PY{o}{.}\PY{n}{data}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Adicione uma coluna com os rótulos}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{lfw\PYZus{}people}\PY{o}{.}\PY{n}{target}

\PY{c+c1}{\PYZsh{} Aplicando PCA}
\PY{n}{lfw\PYZus{}peoplePCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{lfw\PYZus{}peoplePCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Dividindo os dados em conjuntos de treinamento e teste}
\PY{n}{lfw\PYZus{}peopleTest} \PY{o}{=} \PY{n}{lfw\PYZus{}peoplePCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{lfw\PYZus{}peopleTrain} \PY{o}{=} \PY{n}{lfw\PYZus{}peoplePCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{lfw\PYZus{}peopleTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{lfw\PYZus{}peoplePCA0} \PY{o}{=} \PY{n}{lfw\PYZus{}peoplePCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{lfw\PYZus{}peoplePCA1} \PY{o}{=} \PY{n}{lfw\PYZus{}peoplePCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Convertendo em pontos}
\PY{n}{lfw\PYZus{}peoplePCA0} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{lfw\PYZus{}peoplePCA0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{lfw\PYZus{}peoplePCA1} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{lfw\PYZus{}peoplePCA1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando a envoltória convexa}
\PY{n}{lfw\PYZus{}peoplePCA0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{lfw\PYZus{}peoplePCA0}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{lfw\PYZus{}peoplePCA0}\PY{p}{,} \PY{n}{lfw\PYZus{}peoplePCA0Env}\PY{p}{)}

\PY{n}{lfw\PYZus{}peoplePCA1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{lfw\PYZus{}peoplePCA1}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{lfw\PYZus{}peoplePCA1}\PY{p}{,} \PY{n}{lfw\PYZus{}peoplePCA1Env}\PY{p}{)}

\PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{lfw\PYZus{}peoplePCA0Env}\PY{p}{,} \PY{n}{lfw\PYZus{}peoplePCA1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{lfw\PYZus{}peoplePCA0}\PY{p}{,} \PY{n}{lfw\PYZus{}peoplePCA1}\PY{p}{)}

\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{lfw\PYZus{}peoplePCA0}\PY{p}{,} \PY{n}{lfw\PYZus{}peoplePCA1}\PY{p}{)}

\PY{k}{if} \PY{n}{modelo}\PY{p}{:}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lfw\PYZus{}peopleTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_65_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_65_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_65_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Os dados não são linearmente separáveis.
    \end{Verbatim}

    \hypertarget{sobre-o-dataset-mnist}{%
\subsection{Sobre o Dataset MNIST}\label{sobre-o-dataset-mnist}}

O dataset MNIST é um dos conjuntos de dados mais icônicos na área de
Visão Computacional e Aprendizado de Máquina. Ele consiste em uma
coleção de imagens de dígitos manuscritos, escritos à mão por pessoas de
diferentes origens. O MNIST é frequentemente utilizado como um benchmark
para algoritmos de classificação e reconhecimento de dígitos. Em resumo,
o dataset MNIST é uma coleção de imagens de dígitos escritos à mão
amplamente utilizada para o treinamento e avaliação de algoritmos de
classificação e reconhecimento de dígitos. Sua simplicidade e
disponibilidade o tornam uma escolha popular para iniciantes e
profissionais no campo de Aprendizado de Máquina.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k+kn}{import} \PY{n}{fetch\PYZus{}openml}

\PY{n}{mnist} \PY{o}{=} \PY{n}{fetch\PYZus{}openml}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mnist\PYZus{}784}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{version}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{parser}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auto}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{mnist}\PY{o}{.}\PY{n}{data}\PY{p}{)}
\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{mnist}\PY{o}{.}\PY{n}{target}

\PY{c+c1}{\PYZsh{} Aplicando PCA}
\PY{n}{mnistPCA} \PY{o}{=} \PY{n}{apply\PYZus{}pca}\PY{p}{(}\PY{n}{data}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
\PY{n}{mnistPCA}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Dividindo os dados em conjuntos de treinamento e teste}
\PY{n}{mnistTest} \PY{o}{=} \PY{n}{mnistPCA}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
\PY{n}{mnistTrain} \PY{o}{=} \PY{n}{mnistPCA}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{mnistTest}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Acessando as classes separadamente com base na coluna \PYZsq{}label\PYZsq{}}
\PY{n}{mnistPCA0} \PY{o}{=} \PY{n}{mnistPCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{mnistPCA1} \PY{o}{=} \PY{n}{mnistPCA}\PY{p}{[}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Convertendo em pontos}
\PY{n}{mnistPCA0} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{mnistPCA0}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\PY{n}{mnistPCA1} \PY{o}{=} \PY{p}{[}\PY{n}{Ponto}\PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente 2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{mnistPCA1}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} Plotando a envoltória convexa}
\PY{n}{mnistPCA0Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{mnistPCA0}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{mnistPCA0}\PY{p}{,} \PY{n}{mnistPCA0Env}\PY{p}{)}

\PY{n}{mnistPCA1Env} \PY{o}{=} \PY{n}{graham\PYZus{}scan}\PY{p}{(}\PY{n}{mnistPCA1}\PY{p}{)}
\PY{n}{plot\PYZus{}envoltoria}\PY{p}{(}\PY{n}{mnistPCA1}\PY{p}{,} \PY{n}{mnistPCA1Env}\PY{p}{)}

\PY{n}{verificar\PYZus{}separabilidade\PYZus{}linear}\PY{p}{(}\PY{n}{mnistPCA0Env}\PY{p}{,} \PY{n}{mnistPCA1Env}\PY{p}{)}
\PY{n}{plot\PYZus{}separabilidade}\PY{p}{(}\PY{n}{mnistPCA0}\PY{p}{,} \PY{n}{mnistPCA1}\PY{p}{)}

\PY{n}{modelo} \PY{o}{=} \PY{n}{construir\PYZus{}modelo\PYZus{}linear}\PY{p}{(}\PY{n}{mnistPCA0}\PY{p}{,} \PY{n}{mnistPCA1}\PY{p}{)}

\PY{k}{if} \PY{n}{modelo}\PY{p}{:}
    \PY{n}{precisao}\PY{p}{,} \PY{n}{revocacao}\PY{p}{,} \PY{n}{f1} \PY{o}{=} \PY{n}{calcular\PYZus{}metricas}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{mnistTest}\PY{p}{,} \PY{n}{modelo}\PY{p}{,} \PY{n}{positive\PYZus{}label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{negative\PYZus{}label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precisão: }\PY{l+s+si}{\PYZob{}}\PY{n}{precisao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Revocação: }\PY{l+s+si}{\PYZob{}}\PY{n}{revocacao}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F1\PYZhy{}score: }\PY{l+s+si}{\PYZob{}}\PY{n}{f1}\PY{l+s+si}{:}\PY{l+s+s2}{.2f}\PY{l+s+si}{\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_67_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_67_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{main_files/main_67_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Os dados não são linearmente separáveis.
    \end{Verbatim}

    \hypertarget{conclusuxe3o}{%
\section{Conclusão}\label{conclusuxe3o}}

Após a análise e implementação dos algoritmos de geometria
computacional, fica evidente a importância de tais técnicas no campo do
aprendizado de máquina supervisionado. A capacidade de determinar a
separabilidade linear dos dados e ajustar modelos lineares é fundamental
para a construção de classificadores eficazes. Através dos experimentos
realizados, foi possível observar o desempenho do classificador em
diferentes conjuntos de dados, destacando a robustez e precisão do
algoritmo implementado. O trabalho também enfatiza a importância da
avaliação contínua e da validação cruzada para garantir a generalização
do modelo em dados desconhecidos. Em suma, este trabalho prático
proporcionou uma compreensão profunda dos conceitos teóricos discutidos
em sala de aula, reforçando a relevância da geometria computacional no
campo da ciência da computação e aprendizado de máquina.


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
